<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>{{ page.title }}</title>
{%- seo title=false -%}

{% if page.robots %}
  <meta name="robots" content="{{page.robots}}" />
{% endif %}

{%- if site.listen_for_clients_preferred_style -%}
  <link rel="stylesheet" type="text/css" href="{{ "/assets/main.css" | relative_url }}">
{%- else -%}
  {%- if site.style == 'light' -%}
    <link rel="stylesheet" type="text/css" href="{{ "/assets/main-light.css" | relative_url }}">
  {%- elsif site.style == 'hacker' -%}
    <link rel="stylesheet" type="text/css" href="{{ "/assets/main-hacker.css" | relative_url }}">
  {%- else -%}
    <link rel="stylesheet" type="text/css" href="{{ "/assets/main-dark.css" | relative_url }}">
  {%- endif -%}
{%- endif -%}

{%- if jekyll.environment == 'production' and site.google_analytics -%}
  {%- include google-analytics.html -%}
{%- endif -%}

<!-- Mermaid for diagrams -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
  // Initialize mermaid with config
  mermaid.initialize({ 
    startOnLoad: false,
    theme: 'dark',
    themeVariables: {
      primaryColor: '#c678dd',
      primaryTextColor: '#fff',
      primaryBorderColor: '#c678dd',
      lineColor: '#5c6370',
      secondaryColor: '#61afef',
      tertiaryColor: '#98c379',
      background: '#1e1e1e',
      mainBkg: '#1e1e1e',
      secondBkg: '#2d2d2d',
      tertiaryBkg: '#3a3a3a',
      darkMode: true
    }
  });
  
  // Process mermaid blocks after page loads
  window.addEventListener('load', function() {
    // Find all mermaid code blocks
    const codeBlocks = document.querySelectorAll('code.language-mermaid');
    
    codeBlocks.forEach(function(codeBlock) {
      const mermaidCode = codeBlock.textContent;
      
      // Create mermaid div
      const mermaidDiv = document.createElement('div');
      mermaidDiv.className = 'mermaid';
      mermaidDiv.textContent = mermaidCode;
      
      // Find the parent pre element
      const pre = codeBlock.parentElement;
      if (pre && pre.tagName === 'PRE') {
        // Replace the entire pre with mermaid div
        pre.parentNode.replaceChild(mermaidDiv, pre);
      }
    });
    
    // Run mermaid on all .mermaid elements
    if (typeof mermaid !== 'undefined') {
      mermaid.run();
    }
  });
</script>
  
