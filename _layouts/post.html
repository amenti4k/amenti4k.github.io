---
layout: default
---

<div class="post-page">
    {% include toc_left.html %}

    <article class="post">
        <h1>{{ page.title }}</h1>
        <p class="post-meta">
            <time datetime="{{ page.date | date_to_xmlschema }}">{{ page.date | date: "%Y-%m-%d" }}</time>
            <button type="button" onclick="sharePost(this)" class="share-btn" aria-label="Share this post">
                Share
            </button>
        </p>
        <div class="post-content">
            {{ content }}
        </div>
    </article>
</div>

<script>
function setShareFeedback(button, text) {
    if (!button) return;
    if (!button.dataset.originalText) {
        button.dataset.originalText = button.textContent.trim();
    }
    button.textContent = text;
    if (button._resetTimer) {
        clearTimeout(button._resetTimer);
    }
    button._resetTimer = setTimeout(function() {
        button.textContent = button.dataset.originalText;
    }, 1800);
}

async function sharePost(button) {
    const url = window.location.href;
    const title = document.querySelector('.post h1')?.textContent?.trim() || document.title;

    if (navigator.share) {
        try {
            await navigator.share({ title, url });
            setShareFeedback(button, 'Shared');
            return;
        } catch (err) {
            if (err && err.name === 'AbortError') {
                return;
            }
        }
    }

    if (navigator.clipboard && navigator.clipboard.writeText) {
        try {
            await navigator.clipboard.writeText(url);
            setShareFeedback(button, 'Copied');
            return;
        } catch (err) {}
    }

    setShareFeedback(button, 'Copy failed');
}
</script>
